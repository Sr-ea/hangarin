{% load static %}
{% load socialaccount %}
<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<title>{% block title %}Hangarin - Task Manager{% endblock %}</title>
	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
	<link rel="stylesheet" href="{% static 'css/soft-ui-dashboard.min.css' %}">
	<link rel="stylesheet" href="{% static 'css/nucleo-icons.min.css' %}">
	<link rel="stylesheet" href="{% static 'css/form.min.css' %}">
	<link rel="stylesheet" href="{% static 'css/widget.min.css' %}">
	<link href="https://fonts.googleapis.com/css2?family=Abril+Fatface&family=Itim&family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="{% static 'css/soft-ui-dashboard.css' %}">
	<link rel="stylesheet" href="{% static 'css/widget.css' %}">
	<link rel="stylesheet" href="{% static 'css/form.css' %}">
	<link rel="stylesheet" href="{% static 'css/nucleo-svg.css' %}">
	<link rel="stylesheet" href="{% static 'css/nucleo-icons.css' %}">
	<link rel="stylesheet" href="{% static 'css/custom.css' %}">
	<link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
	
	<style>
		:root {
			--sunshine-yellow: #FFD166;
			--sky-blue: #118AB2;
			--ocean-blue: #073B4C;
			--cloud-white: #FFFFFF;
			--light-gradient: linear-gradient(135deg, #FFD166 0%, #118AB2 50%, #FFFFFF 100%);
			--sidebar-gradient: linear-gradient(180deg, #073B4C 0%, #118AB2 100%);
			--card-gradient: linear-gradient(135deg, #FFFFFF 0%, #E6F7FF 100%);
		}

		body {
			background: var(--light-gradient);
			background-attachment: fixed;
			min-height: 100vh;
			font-family: 'Itim', sans-serif;
			font-weight: 400;
			line-height: 1.6;
			transition: all 0.3s ease;
		}

		.wrapper {
			background: transparent;
			display: flex;
			flex-direction: column;
			min-height: 100vh;
		}

		/* Top Navigation Bar */
		.top-navbar {
			background: rgba(255, 255, 255, 0.95);
			backdrop-filter: blur(10px);
			border-bottom: 2px solid var(--sunshine-yellow);
			box-shadow: 0 4px 15px rgba(17, 138, 178, 0.1);
			position: sticky;
			top: 0;
			z-index: 1000;
			padding: 10px 20px;
		}

		
		.navbar-content {
			display: flex;
			align-items: center;
			justify-content: space-between;
		}

		.navbar-left {
			display: flex;
			align-items: center;
			gap: 20px;
		}

		.navbar-right {
			display: flex;
			align-items: center;
			gap: 15px;
		}

		.logo {
			color: var(--ocean-blue);
			font-weight: 800;
			font-size: 1.5rem;
			font-family: 'Itim', cursive;
			text-decoration: none;
			display: flex;
			align-items: center;
			gap: 10px;
		}

		.search-bar {
			position: relative;
			width: 300px;
		}

		.search-bar input {
			width: 100%;
			padding: 8px 15px;
			border-radius: 20px;
			border: 1px solid var(--sky-blue);
			background: rgba(255, 255, 255, 0.8);
			font-family: 'Itim', cursive;
		}

		.nav-button {
			background: none;
			border: none;
			color: var(--ocean-blue);
			font-size: 1.2rem;
			cursor: pointer;
			padding: 8px 12px;
			border-radius: 8px;
			transition: all 0.3s ease;
			display: flex;
			align-items: center;
			gap: 5px;
			font-family: 'Itim', cursive;
		}

		.nav-button:hover {
			background: rgba(17, 138, 178, 0.1);
			transform: scale(1.05);
		}

		.profile-dropdown {
			position: relative;
		}

		.profile-button {
			display: flex;
			align-items: center;
			gap: 8px;
			background: none;
			border: none;
			cursor: pointer;
			padding: 5px 10px;
			border-radius: 20px;
			transition: all 0.3s ease;
		}

		.profile-button:hover {
			background: rgba(17, 138, 178, 0.1);
		}

		.profile-pic {
    border-radius: 50% !important;
    object-fit: fill !important;
}

.header-profile-photo img {
    border-radius: 50% !important;
    object-fit: contain !important;
}

.profile-button img {
    border-radius: 100% !important;
    object-fit: fill !important;
}

.dropdown-menu .u-img img {
    border-radius: 50% !important;
    object-fit: contain !important;
}

/* Ensure consistent sizing */
.profile-button img,
.dropdown-header img,
.profile-pic {
    border-radius: 50% !important;
    object-fit: cover !important;
    width: 36px !important;
    height: 36px !important;
}

.dropdown-header img {
    width: 60px !important;
    height: 60px !important;
}

.dropdown-menu .u-img img {
    width: 60px;
    height: 60px;
    border: 2px solid var(--sunshine-yellow);
}
		.dropdown-menu {
			position: absolute;
			right: 0;
			top: 100%;
			background: white;
			border-radius: 10px;
			box-shadow: 0 5px 15px rgba(0,0,0,0.1);
			min-width: 200px;
			display: none;
			z-index: 1001;
			border: 1px solid var(--sunshine-yellow);
		}

		.dropdown-menu.show {
			display: block;
		}

		.dropdown-item {
			padding: 10px 15px;
			display: flex;
			align-items: center;
			gap: 10px;
			text-decoration: none;
			color: var(--ocean-blue);
			border-bottom: 1px solid #f0f0f0;
			transition: all 0.3s ease;
		}

		.dropdown-item:hover {
			background: rgba(17, 138, 178, 0.1);
		}

		.dropdown-item:last-child {
			border-bottom: none;
		}

		/* Left Sidebar */
		.left-sidebar {
			position: fixed;
			left: -300px;
			top: 0;
			width: 300px;
			height: 100vh;
			background: var(--sidebar-gradient);
			transition: all 0.3s ease;
			z-index: 1002;
			border-right: 3px solid var(--sunshine-yellow);
			overflow-y: auto;
		}

		.left-sidebar.open {
			left: 0;
		}

		.sidebar-header {
			padding: 20px;
			border-bottom: 1px solid rgba(255, 255, 255, 0.2);
			display: flex;
			justify-content: space-between;
			align-items: center;
		}

		.sidebar-title {
			color: white;
			font-size: 1.2rem;
			font-family: 'Itim', cursive;
		}

		.close-sidebar {
			background: none;
			border: none;
			color: white;
			font-size: 1.2rem;
			cursor: pointer;
		}

		.sidebar-nav {
			padding: 20px;
		}

		.sidebar-nav-item {
			margin-bottom: 10px;
		}

		.sidebar-nav-item a {
			display: flex;
			align-items: center;
			gap: 10px;
			padding: 12px 15px;
			color: white;
			text-decoration: none;
			border-radius: 8px;
			transition: all 0.3s ease;
		}

		.sidebar-nav-item a:hover {
			background: rgba(255, 255, 255, 0.1);
			transform: translateX(5px);
		}

		.sidebar-overlay {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(0,0,0,0.5);
			z-index: 1001;
			display: none;
		}

		.sidebar-overlay.show {
			display: block;
		}

		/* Main Content */
		.main-content {
			flex: 1;
			padding: 20px;
			margin-top: 0;
			transition: all 0.3s ease;
		}

		/* When sidebar is open, shift main content slightly */
		.left-sidebar.open + .sidebar-overlay + .main-content {
			margin-left: 300px;
		}

		/* Rest of your existing card and component styles remain the same */
		.card {
			background: var(--card-gradient);
			border: none;
			border-radius: 20px;
			box-shadow: 0 8px 25px rgba(7, 59, 76, 0.1);
			backdrop-filter: blur(10px);
			margin-bottom: 25px;
			transition: all 0.3s ease;
			border-left: 4px solid var(--sky-blue);
		}

		.card:hover {
			transform: translateY(-5px);
			box-shadow: 0 15px 35px rgba(17, 138, 178, 0.2);
		}

		.card-header {
			background: transparent;
			border-bottom: 2px solid rgba(255, 209, 102, 0.3);
			border-radius: 20px 20px 0 0 !important;
			padding: 20px 25px;
		}

		.card-title {
			color: var(--ocean-blue);
			font-weight: 700;
			font-size: 1.3rem;
			font-family: 'Itim', cursive;
		}

		.card-category {
			color: var(--sky-blue);
			font-weight: 500;
			font-family: 'Itim', cursive;
		}

		.btn-primary {
			background: linear-gradient(135deg, var(--sky-blue), var(--ocean-blue));
			border: none;
			border-radius: 25px;
			padding: 10px 25px;
			font-weight: 600;
			box-shadow: 0 4px 15px rgba(17, 138, 178, 0.3);
			transition: all 0.3s ease;
			font-family: 'Itim', cursive;
		}

		.btn-primary:hover {
			transform: translateY(-2px);
			box-shadow: 0 6px 20px rgba(17, 138, 178, 0.4);
			background: linear-gradient(135deg, var(--ocean-blue), var(--sky-blue));
		}

	.dropdown-header {
		padding: 0;
		background: rgba(7, 59, 76, 0.05);
		border-bottom: 1px solid rgba(0,0,0,0.1);
	}

	.profile-pic.square {
    border-radius: 2px !important;


	}		

	.dropdown-header .fw-bold {
		color: var(--ocean-blue);
		font-size: 0.95rem;
	}

	.dropdown-header .text-muted {
		font-size: 0.8rem;
	}


		/* Animation */
		@keyframes fadeInUp {
			from {
				opacity: 0;
				transform: translateY(30px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		.card {
			animation: fadeInUp 0.6s ease-out;
		}

		/* Responsive */
		@media (max-width: 768px) {
			.navbar-content {
				flex-wrap: wrap;
			}

			.search-bar {
				width: 200px;
			}

			.nav-button span {
				display: none;
			}

			.left-sidebar {
				width: 280px;
			}

			/* On mobile, sidebar overlay should cover entire screen */
			.left-sidebar.open + .sidebar-overlay + .main-content {
				margin-left: 0;
			}
		}

		@media (max-width: 576px) {
			.search-bar {
				width: 150px;
			}

			.navbar-left {
				gap: 10px;
			}

			.navbar-right {
				gap: 10px;
			}
		}
	</style>
</head>
<body>
	<div class="wrapper">
		<!-- Top Navigation Bar -->
		<nav class="top-navbar">
			<div class="navbar-content">
				<div class="navbar-left">
					<button class="nav-button" id="sidebarToggler">
						<i class="fas fa-bars"></i>
						<span>Menu</span>
					</button>
				</div>

				<div class="navbar-left">
					<a href="{% url 'home' %}" class="logo">
						<i class="fas fa-tasks"></i> Hangarin
					</a>
				</div>

				<div class="navbar-right">
					<div class="profile-dropdown">
						<button class="profile-button">
							{% if user.is_authenticated %}
								{% if user.socialaccount_set.all.0.get_avatar_url %}
									<img src="{{ user.socialaccount_set.all.0.get_avatar_url }}" alt="Profile" class="profile-pic square">
								{% else %}
									<img src="{% static 'img/profile_ko.jpg' %}" alt="Profile" class="profile-pic">
								{% endif %}
								<span>Welcome, {{ user.first_name|default:user.username }}!</span>
							{% else %}
								<img src="{% static 'img/profile_ko.jpg' %}" alt="Profile" class="profile-pic">
								<span>Welcome!</span>
							{% endif %}
						</button>
						<div class="dropdown-menu" id="profileDropdown">
							{% if user.is_authenticated %}
								<div class="dropdown-header">
									<div class="d-flex align-items-center px-3 py-2">
										{% if user.socialaccount_set.all.0.get_avatar_url %}
											<img src="{{ user.socialaccount_set.all.0.get_avatar_url }}" alt="Profile" class="profile-pic me-2">
										{% else %}
											<img src="{% static 'img/profile_ko.jpg' %}" alt="Profile" class="profile-pic me-2">
										{% endif %}
										<div>
											<div class="fw-bold">{{ user.get_full_name|default:user.username }}</div>
											<small class="text-muted">{{ user.email }}</small>
										</div>
									</div>
								</div>
								<div class="dropdown-divider"></div>
							{% endif %}
							<a href="#" class="dropdown-item">
								<i class="fas fa-user"></i> My Account
							</a>
							<a href="#" class="dropdown-item">
								<i class="fas fa-cog"></i> Settings
							</a>
							<div class="dropdown-divider"></div>
							{% if user.is_authenticated %}
								<a href="{% url 'account_logout' %}" class="dropdown-item">
									<i class="fas fa-sign-out-alt"></i> Logout
								</a>
							{% else %}
								<a href="{% url 'account_login' %}" class="dropdown-item">
									<i class="fas fa-sign-in-alt"></i> Login
								</a>
							{% endif %}
						</div>
					</div>
				</div>
			</div>
		</nav>

		<!-- Left Sidebar -->
		<div class="left-sidebar" id="leftSidebar">
			<div class="sidebar-header">
				<h3 class="sidebar-title">Hangarin</h3>
				<button class="close-sidebar" id="closeSidebarBtn">
					<i class="fas fa-times"></i>
				</button>
			</div>
			<div class="sidebar-nav">
				<div class="sidebar-nav-item">
					<a href="{% url 'home' %}">
						<i class="fas fa-home"></i>
						<span>Dashboard</span>
					</a>
				</div>
				<div class="sidebar-nav-item">
					<a href="{% url 'task-list' %}">
						<i class="fas fa-tasks"></i>
						<span>All Tasks</span>
					</a>
				</div>
				<div class="sidebar-nav-item">
					<a href="{% url 'category-list' %}">
						<i class="fa-solid fa-bookmark"></i>
						<span>Categories</span>
					</a>
				</div>
				<div class="sidebar-nav-item">
					<a href="{% url 'priority-list' %}">
						<i class="fas fa-flag"></i>
						<span>Priorities</span>
					</a>
				</div>
				<div class="sidebar-nav-item">
					<a href="{% url 'note-list' %}">
						<i class="fas fa-sticky-note"></i>
						<span>Notes</span>
					</a>
				</div>
				<div class="sidebar-nav-item">
					<a href="{% url 'subtask-list' %}">
						<i class="fas fa-check-square"></i>
						<span>Subtasks</span>
					</a>
				</div>
			</div>
		</div>

		<!-- Sidebar Overlay -->
		<div class="sidebar-overlay" id="sidebarOverlay"></div>

		<!-- Main Content -->
		<div class="main-content">
			{% block content %}
			{% endblock %}
		</div>
	</div>

	<!-- Add Task Modal -->
	<div class="modal fade" id="modalAddTask" tabindex="-1" role="dialog" aria-labelledby="modalAddTask" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document">
			<div class="modal-content" style="border-radius: 20px;">
				<div class="modal-header bg-primary text-white" style="border-radius: 20px 20px 0 0;">
					<h6 class="modal-title"><i class="fas fa-plus-circle"></i> Add New Task</h6>
					<button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body text-center">									
					<div class="py-4">
						<i class="fas fa-plus-circle fa-3x text-primary mb-3"></i>
						<p>Ready to create something amazing?</p>
						<p><b>Task creation feature coming soon!</b></p>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
				</div>
			</div>
		</div>
	</div>

	<!-- JavaScript Files -->
	<script src="{% static 'js/core/jquery.3.2.1.min.js' %}"></script>
	<script src="{% static 'js/plugin/jquery-ui-1.12.1.custom/jquery-ui.min.js' %}"></script>
	<script src="{% static 'js/core/popper.min.js' %}"></script>
	<script src="{% static 'js/core/bootstrap.min.js' %}"></script>
	<script src="{% static 'js/ready.min.js' %}"></script>

	<script>
		document.addEventListener('DOMContentLoaded', function() {
			const sidebarToggler = document.getElementById('sidebarToggler');
			const leftSidebar = document.getElementById('leftSidebar');
			const closeSidebarBtn = document.getElementById('closeSidebarBtn');
			const sidebarOverlay = document.getElementById('sidebarOverlay');
			const profileButton = document.querySelector('.profile-button');
			const profileDropdown = document.getElementById('profileDropdown');

			// Function to open sidebar
			function openSidebar() {
				leftSidebar.classList.add('open');
				sidebarOverlay.classList.add('show');
			}

			// Function to close sidebar
			function closeSidebar() {
				leftSidebar.classList.remove('open');
				sidebarOverlay.classList.remove('show');
			}

			// Toggle left sidebar
			sidebarToggler.addEventListener('click', function() {
				if (leftSidebar.classList.contains('open')) {
					closeSidebar();
				} else {
					openSidebar();
				}
			});

			// Close sidebar with close button
			closeSidebarBtn.addEventListener('click', function() {
				closeSidebar();
			});

			// Close sidebar when clicking overlay
			sidebarOverlay.addEventListener('click', function() {
				closeSidebar();
			});

			// Toggle profile dropdown
			profileButton.addEventListener('click', function(e) {
				e.stopPropagation();
				profileDropdown.classList.toggle('show');
			});

			// Close dropdown when clicking elsewhere
			document.addEventListener('click', function() {
				profileDropdown.classList.remove('show');
			});

			// Add animation to cards on load
			const cards = document.querySelectorAll('.card');
			cards.forEach((card, index) => {
				card.style.animationDelay = `${index * 0.1}s`;
			});

			// Close sidebar when clicking on a link
			const sidebarLinks = document.querySelectorAll('.sidebar-nav-item a, .sidebar-nav-item button');
			sidebarLinks.forEach(link => {
				link.addEventListener('click', function() {
					closeSidebar();
				});
			});

			// Close sidebar when pressing Escape key
			document.addEventListener('keydown', function(e) {
				if (e.key === 'Escape') {
					closeSidebar();
				}
			});
		});
	</script>
</body>
</html>